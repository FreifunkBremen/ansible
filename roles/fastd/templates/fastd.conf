# {{ ansible_managed }}

log to syslog level warn;
hide ip addresses yes;
status socket "/run/fastd-{{ site_code }}.sock";

interface "{{ fastd_interface_name }}";

method "salsa2012+umac";
method "salsa2012+gmac";
method "xsalsa20-poly1305";
method "null";

secure handshakes yes;

# Bind to IPv4 only
bind 0.0.0.0:{{ fastd_port }};

include "secret.conf";

mtu {{ fastd_mtu }};

{% if fastd_peers_limit > -1 %}
peer limit {{ fastd_peers_limit }};
{% endif %}

on up "ifup --allow hotplug {{ fastd_interface_name }}";
on down "ifdown --allow hotplug {{ fastd_interface_name }}";

on verify "/etc/fastd/{{ site_code }}/blacklist.sh /opt/{{ site_code }}/vpn-blacklist/blacklist.json";

include peers from "peers";
