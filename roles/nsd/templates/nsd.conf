# {{ ansible_managed }}
server:
  hide-version: yes
  identity: "unidentified server"
{% if "address" in ansible_default_ipv4 %}
  ip-address: {{ ansible_default_ipv4.address }}
{% endif %}
{% if "address" in ansible_default_ipv6 %}
  ip-address: {{ ansible_default_ipv6.address }}
{% endif %}
  ip4-only: no
  ip6-only: no
  debug-mode: no
  pidfile: "/var/run/nsd.pid"
  zonesdir: "/var/lib/nsd"
  verbosity: 0

{% if "dnsserver" in group_names %}
pattern:
  name: default
  zonefile: "%s.zone"
  # moritzrudert.de
  notify: 176.9.147.213 NOKEY
  provide-xfr: 176.9.147.213 NOKEY
  notify: 2a01:4f8:160:30c2::8 NOKEY
  provide-xfr: 2a01:4f8:160:30c2::8 NOKEY
  provide-xfr: 2a01:4f8:160:30c2::12 NOKEY
  # dns.he.net
  notify: 216.218.130.2 NOKEY
  provide-xfr: 216.218.133.2 NOKEY
  provide-xfr: 2001:470:600::2 NOKEY

zone:
  name: {{ dns_domain_freifunk_net }}
  include-pattern: default

zone:
  name: nodes.{{ dns_domain_freifunk_net }}
  include-pattern: default

zone:
  name: {{ site_code }}.de
  include-pattern: default
  zonefile: {{ dns_domain_freifunk_net }}.zone

zone:
  name: nodes.{{ site_code }}.de
  include-pattern: default
  zonefile: nodes.{{ dns_domain_freifunk_net }}.zone
{% else %}
zone:
  name: {{ site_code }}
  zonefile: {{ site_code }}.zone

zone:
  name: nodes.{{ site_domain }}
  zonefile: {{ site_domain.split('.')|reverse|join('.')}}.nodes.zone

#TODO FFHB Spezifisch
zone:
  name: nodes.{{ site_code }}.de
  zonefile: {{ site_domain.split('.')|reverse|join('.')}}.nodes.zone
{% endif %}
