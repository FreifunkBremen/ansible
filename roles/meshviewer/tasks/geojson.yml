---
- name: Clone repository
  git:
    repo: "{{ meshviewer_geojson_git_root }}"
    dest: "/opt/meshviewer_geojson_git"
    force: yes
    version: "{{ meshviewer_geojson_git_commit }}"

- name: Install script to copy valide geojson
  template:
    src: geojson-update.sh
    dest: /usr/local/bin/geojson-update
    owner: root
    group: root
    mode: 0755

- name: Install timer
  import_role:
    name: timer
  vars:
    timer_name: geojson-update
    timer_exec: /usr/local/bin/geojson-update
    timer_interval: 5min

- name: Remove legacy cronjob
  file:
    path: /etc/cron.d/geojson-update
    state: absent
