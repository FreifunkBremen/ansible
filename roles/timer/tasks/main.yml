---
- name: Fail when timer_name is empty
  fail: msg="timer_name is empty"
  when: not timer_name

- name: Upload service and timer
  template:
    src: "job.{{ item }}"
    dest: "/etc/systemd/system/{{ timer_name }}.{{ item }}"
  with_items:
  - service
  - timer
  notify: reload systemd

- name: Enable and start timer
  service:
    name: "{{ timer_name }}.timer"
    enabled: yes
    state: started
