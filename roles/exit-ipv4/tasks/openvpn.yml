---
- name: Install packages
  apt: name={{ item }}
  with_items:
    - openvpn

- name: Install configuration
  template: >
    src=openvpn/exit.conf
    dest=/etc/openvpn/
  notify: restart openvpn

- name: Upload credentials
  template: >
    src=openvpn/exit-auth
    dest=/etc/openvpn/
    mode=0600
  when: exit_ipv4_openvpn_username is defined
  notify: restart openvpn

- name: Install script
  template: >
    src=openvpn/exit-up.sh
    dest=/etc/openvpn/
    mode=0700
  notify: restart openvpn
